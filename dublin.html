<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dublin, CA Outdoor Activities Guide</title>
    <style>
        /* Minimal styling copied from Reno site for consistency */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f6f8fb; padding: 20px; }
        .container { max-width: 1100px; margin: 0 auto; background: white; border-radius: 8px; padding: 20px; }
        header { text-align: center; padding: 20px 0; }
        .search-box { width: 100%; padding: 10px; margin-bottom: 15px; }
        .activity-card { border-left: 5px solid #3498db; padding: 15px; margin-bottom: 12px; border-radius: 6px; background: #f8f9fa; }
        .category-badge { display:inline-block; padding:3px 8px; background:#e74c3c;color:#fff;border-radius:12px; font-size:0.8em; }
        .season-badge { display:inline-block; padding:3px 8px; background:#95a5a6;color:#fff;border-radius:12px; font-size:0.8em; margin-left:6px }
        /* Colorful filter buttons similar to Reno styling */
        .filter-btn { border: none; padding: 8px 12px; margin-right:6px; margin-bottom:6px; border-radius: 999px; cursor:pointer; color: #fff; font-weight:600; background: linear-gradient(90deg,#7bd389,#34c6a9); box-shadow: 0 2px 6px rgba(0,0,0,0.08); }
        .filter-btn:hover { transform: translateY(-1px); }
        .filter-btn.active { box-shadow: 0 4px 14px rgba(0,0,0,0.12); }
        /* make category badges brighter */
        .category-badge { background: linear-gradient(90deg,#ff7e5f,#feb47b); }
        .season-badge { background: linear-gradient(90deg,#6a11cb,#2575fc); }
        .loading, .error, .no-results { text-align:center; padding:20px; }
        .back-link { display:inline-block; margin-top:8px; padding:6px 10px; border-radius:8px; background: #3498db; color:#fff; text-decoration:none; font-weight:600 }
        .back-link:hover { opacity:0.95; transform:translateY(-1px); }
        .share-btn { display:inline-block; padding:6px 10px; border-radius:8px; background: #25D366; color:#fff; text-decoration:none; font-weight:600; margin-left:8px }
        .share-btn:hover { opacity:0.95; transform:translateY(-1px); }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìç Dublin, CA Outdoor Activities Guide</h1>
            <p>Explore outdoor activities around Dublin, California ‚Äî Spring 2026</p>
            <p><a class="back-link" href="index.html">‚Üê Back to Index</a></p>
        </header>

        <div class="loading" id="loadingMessage">Loading activities data...</div>
        <div class="error" id="errorMessage" style="display:none;"></div>
        <div id="fileLoader" style="display:none; text-align:center; padding:10px;">
            <p style="color:#666">If automatic loading fails, select the CSV file manually:</p>
            <input type="file" id="csvFileInput" accept=".csv" />
        </div>

        <div id="cards" style="display:none;">
            <div class="stats-section" id="statsSection" style="margin-bottom:15px"></div>
            <input type="text" id="searchBox" class="search-box" placeholder="üîç Search activities, locations, or categories..." onkeyup="filterActivities()">
            <div style="display:flex; gap:10px; margin-bottom:12px; flex-wrap:wrap">
                <div id="categoryFilters"></div>
                <div id="seasonFilters"></div>
            </div>
            <div id="activitiesContainer"></div>
            <div id="noResults" class="no-results" style="display:none;">No activities found.</div>
        </div>

        <footer style="text-align:center; margin-top:20px; color:#666">
            <p>¬© 2026 Dublin Outdoor Activities Guide</p>
        </footer>
    </div>

    <script>
        let activitiesData = [];
        let filteredData = [];

        async function loadCSV() {
            try {
                const csvPath = 'dublin_outdoor_activities.csv';
                const response = await fetch(csvPath);
                if (!response.ok) throw new Error('Could not load CSV');
                const csvText = await response.text();
                activitiesData = parseCSV(csvText);
                filteredData = activitiesData;
                document.getElementById('loadingMessage').style.display = 'none';
                document.getElementById('cards').style.display = 'block';
                renderStats();
                renderFilters();
                renderActivities();
            } catch (err) {
                console.error(err);
                document.getElementById('loadingMessage').style.display = 'none';
                document.getElementById('errorMessage').style.display = 'block';
                document.getElementById('errorMessage').textContent = 'Error loading activities data. You can select the CSV file manually below.';
                document.getElementById('fileLoader').style.display = 'block';
            }
        }

        function parseCSV(csv) {
            const lines = csv.trim().split('\n').filter(l => l.trim() !== '');
            if (lines.length === 0) return [];
            let headers = lines[0].split(',').map(h => h.trim());
            while (headers.length > 0 && headers[headers.length-1] === '') headers.pop();
            const data = [];
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i];
                const values = [];
                let current = '';
                let insideQuotes = false;
                for (let k=0;k<line.length;k++){
                    const ch = line[k];
                    if (ch === '"') { if (insideQuotes && line[k+1] === '"') { current += '"'; k++; } else insideQuotes = !insideQuotes; }
                    else if (ch === ',' && !insideQuotes) { values.push(current.trim()); current = ''; }
                    else { current += ch; }
                }
                values.push(current.trim());
                if (values.length > headers.length) values.length = headers.length; while (values.length < headers.length) values.push('');
                const obj = {};
                for (let j=0;j<headers.length;j++) obj[headers[j]] = values[j] || '';
                data.push(obj);
            }
            return data;
        }

        function createActivityCard(a){
            const searchText = `${a['Activity Name']} ${a.Category} ${a.Location} ${a.Description}`.toLowerCase();
            const shareText = `${a.Date} - ${a['Activity Name']}\nLocation: ${a.Location}\nPhone: ${a['Phone Number']}\nWebsite: ${a.Website}\n\n${a.Description}\nBest Season: ${a['Best Season']}`;
            const shareUrl = 'https://wa.me/?text=' + encodeURIComponent(shareText);
            return `
                <div class="activity-card" data-search="${searchText}" data-category="${a.Category}" data-season="${a['Best Season']}">
                    <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:10px;">
                        <div style="min-width:60%"><div style="font-weight:700">${a['Activity Name']}</div><div style="color:#666; font-size:0.95em;">${a.Location}</div></div>
                        <div style="text-align:right">
                            <div><span class="category-badge">${a.Category}</span><span class="season-badge">${a['Best Season']}</span></div>
                            <div style="margin-top:8px; font-size:0.9em"><a href="tel:${a['Phone Number']}">${a['Phone Number']}</a> ‚Ä¢ <a href="http://${a.Website}" target="_blank">Website</a></div>
                        </div>
                    </div>
                    <div style="margin-top:10px; color:#333">${a.Description}</div>
                    <div style="margin-top:10px; display:flex; justify-content:flex-end;"><a class="share-btn" href="${shareUrl}" target="_blank" rel="noopener noreferrer">Share on WhatsApp</a></div>
                </div>
            `;
        }

        function renderStats() {
            const categories = [...new Set(activitiesData.map(a => a.Category))];
            const seasons = [...new Set(activitiesData.map(a => a['Best Season']))];
            document.getElementById('statsSection').innerHTML = `
                <div style="display:flex; gap:12px; flex-wrap:wrap">
                    <div style="background:#3498db;color:#fff;padding:10px;border-radius:6px;">Total: <strong>${activitiesData.length}</strong></div>
                    <div style="background:#2ecc71;color:#fff;padding:10px;border-radius:6px;">Categories: <strong>${categories.length}</strong></div>
                    <div style="background:#9b59b6;color:#fff;padding:10px;border-radius:6px;">Seasons: <strong>${seasons.length}</strong></div>
                </div>
            `;
        }

        function renderFilters() {
            const categories = [...new Set(activitiesData.map(a => a.Category))].sort();
            const seasons = [...new Set(activitiesData.map(a => a['Best Season']))].sort();
            document.getElementById('categoryFilters').innerHTML = `<button class="filter-btn active" onclick="filterByCategory('all', this)">All Categories</button>` + categories.map(c=>`<button class="filter-btn" onclick="filterByCategory('${c}', this)">${c}</button>`).join('');
            document.getElementById('seasonFilters').innerHTML = `<button class="filter-btn active" onclick="filterBySeason('all', this)">All Seasons</button>` + seasons.map(s=>`<button class="filter-btn" onclick="filterBySeason('${s}', this)">${s}</button>`).join('');
        }

        function filterByCategory(category, btn) {
            const buttons = document.querySelectorAll('#categoryFilters .filter-btn');
            buttons.forEach(b=>b.classList.remove('active'));
            if (btn) btn.classList.add('active');
            if (category === 'all') filteredData = activitiesData; else filteredData = activitiesData.filter(a=>a.Category===category);
            renderActivities();
            document.getElementById('searchBox').value='';
        }

        function filterBySeason(season, btn) {
            const buttons = document.querySelectorAll('#seasonFilters .filter-btn');
            buttons.forEach(b=>b.classList.remove('active'));
            if (btn) btn.classList.add('active');
            if (season === 'all') filteredData = activitiesData; else filteredData = activitiesData.filter(a=>a['Best Season']===season);
            renderActivities();
            document.getElementById('searchBox').value='';
        }

        function renderActivities(){
            const container = document.getElementById('activitiesContainer');
            container.innerHTML = filteredData.map(createActivityCard).join('');
        }

        function filterActivities(){
            const term = document.getElementById('searchBox').value.toLowerCase();
            const cards = document.querySelectorAll('#activitiesContainer .activity-card');
            let visible = 0;
            cards.forEach(c=>{ const s=c.getAttribute('data-search'); if(s.includes(term)){ c.style.display='block'; visible++; } else c.style.display='none'; });
            document.getElementById('noResults').style.display = visible===0 ? 'block':'none';
        }

        // file input fallback
        document.getElementById('csvFileInput').addEventListener('change', function(e){ const f = e.target.files[0]; if(!f) return; const r=new FileReader(); r.onload=function(ev){ activitiesData=parseCSV(ev.target.result); filteredData=activitiesData; document.getElementById('errorMessage').style.display='none'; document.getElementById('fileLoader').style.display='none'; document.getElementById('cards').style.display='block'; renderActivities(); }; r.readAsText(f); });

        window.addEventListener('DOMContentLoaded', loadCSV);
    </script>
</body>
</html>